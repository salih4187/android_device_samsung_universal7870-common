# Allow reading of sysfs nodes to find input devices
# allow hal_power_default sysfs:dir r_dir_perms;
# allow hal_power_default sysfs:file r_file_perms;

# Allow reading of sysfs nodes to find input devices | neverallow
# allow hal_power_default sysfs:dir r_dir_perms;
# allow hal_power_default sysfs:file rw_file_perms;

# Input devices
allow hal_power_default sysfs_input:dir r_dir_perms;
allow hal_power_default sysfs_input:file rw_file_perms;

# CPU devices
allow hal_power_default sysfs_devices_system_cpu:dir r_dir_perms;
allow hal_power_default sysfs_devices_system_cpu:file rw_file_perms;

# Graphics
allow hal_power_default sysfs_graphics:dir search;
allow hal_power_default sysfs_graphics:file rw_file_perms;

# virtual
allow hal_power_default sysfs_virtual:dir r_dir_perms;
allow hal_power_default sysfs_virtual:file rw_file_perms;

# neverallow default_android_hwservice
# allow hal_power_default default_android_hwservice:hwservice_manager { find add };

dontaudit hal_power_default default_android_hwservice:hwservice_manager { find add };

allow hal_power_default{
    sysfs_backlight_writable
    sysfs_batteryinfo
    sysfs_light
    sysfs_sec_tsp
}:dir r_dir_perms;

allow hal_power_default{
    pm_qos_device
    sysfs_backlight_writable
    sysfs_batteryinfo
    sysfs_light
    sysfs_sec_tsp
}:file rw_file_perms;
